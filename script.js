!function(n){"use strict";var e,t,r,u=function(n,e,t){n.addEventListener(e,t,!1)},o=function(n){var e,t,r={};for(e=0;e<n.length;e++){var t=n[e];if(r.hasOwnProperty(t))return!1;r[t]=!0}return!0},a=function(n,e){var t,r,u="",o={};for(t=0;e>t;t++){do r=Math.floor(Math.random()*n.length);while(o[r]);o[r]=!0,u+=n[r]}return u},i=function(n,e){var t,r,u=0,o=0,a=n.length;for(t=0;a>t;t++)for(r=0;a>r;r++)n[t]===e[r]&&(t===r?o++:u++);return[o,u,o===a?!0:!1]},c=function(n,t,r){var u,c,f;if(t=parseInt(t,10),!o(n))throw new Error("Base is not unique");if(n.length<=t)throw new Error("Length is more than number of symbols");return u=r||a(n,t),e("number",u),c=new RegExp("^["+n+"]{"+t+"}$"),f=function(n){return c.test(n)&&o(n)?i(n,u):!1},{check:f}},f=function(n){return function(t,r){var u=document.createElement("li");u.innerHTML=t+": "+r[0]+"b, "+r[1]+"c",n.insertBefore(u,n.firstChild),e("output",n.innerHTML)}},l=function(n,o){var a,i=n.elements,l=o.elements.guess,s=t("base"),v=t("length"),m=t("number"),h=o.querySelector("#output"),g=f(h),b=function(){h.innerHTML="",r(),a=w()},w=function(n){var t,r=i.base.value,u=i.number.value;return t=c(r,u,n),l.value="",l.focus(),e("base",r),e("length",u),t};s&&(i.base.value=s),v&&(i.number.value=v),a=w(m),h.innerHTML=t("output")||"",u(n,"submit",function(n){n.preventDefault(),b()}),u(n,"reset",function(){b()}),u(o,"submit",function(n){n.preventDefault();var e=a.check(l.value);e?(g(l.value,e),e[2]===!0&&confirm("You win! Start new game?")&&b(),l.value=""):alert("Invalid number"),l.focus()})};n.localStorage?(e=function(e,t){n.localStorage.setItem(e,t)},t=function(e){return n.localStorage.getItem(e)},r=function(){n.localStorage.clear()}):(e=function(){},t=function(){},r=function(){}),n.Game=l}(window);
