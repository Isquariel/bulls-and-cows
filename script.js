!function(n){"use strict";var e,t,r,u=function(n,e,t){n.addEventListener(e,t,!1)},o=function(n){var e,t,r={};for(e=0;e<n.length;e++){var t=n[e];if(r.hasOwnProperty(t))return!1;r[t]=!0}return!0},a=function(n,e){var t,r,u,o={};do r=Math.floor(Math.random()*n.length);while(0===r);for(o[r]=!0,u=n[r],t=1;e>t;t++){do r=Math.floor(Math.random()*n.length);while(o[r]);o[r]=!0,u+=n[r]}return u},i=function(n,e){var t,r,u=0,o=0,a=n.length;for(t=0;a>t;t++)for(r=0;a>r;r++)n[t]===e[r]&&(t===r?o++:u++);return[o,u,o===a?!0:!1]},l=function(n,t,r){var u,l,c;if(t=parseInt(t,10),!o(n))throw new Error("Base is not unique");if(n.length<=t)throw new Error("Length is more than number of symbols");return u=r||a(n,t),e("number",u),l=new RegExp("^["+n+"]{"+t+"}$"),c=function(e){return l.test(e)&&e[0]!==n[0]&&o(e)?i(e,u):!1},{check:c}},c=function(n){return function(t,r){var u=document.createElement("li");u.innerHTML=t+": "+r[0]+"b, "+r[1]+"c",n.insertBefore(u,n.firstChild),e("output",n.innerHTML)}},f=function(n,o){var a,i=n.elements,f=o.elements.guess,s=t("base"),v=t("length"),h=t("number"),m=o.querySelector("#output"),g=c(m),b=function(){m.innerHTML="",r(),a=w()},w=function(n){var t,r=i.base.value,u=i.number.value;return t=l(r,u,n),f.value="",f.focus(),e("base",r),e("length",u),t};s&&(i.base.value=s),v&&(i.number.value=v),a=w(h),m.innerHTML=t("output")||"",u(n,"submit",function(n){n.preventDefault(),b()}),u(n,"reset",function(){b()}),u(o,"submit",function(n){n.preventDefault();var e=a.check(f.value);e?(g(f.value,e),e[2]===!0&&confirm("You win! Start new game?")&&b(),f.value=""):alert("Invalid number"),f.focus()})};n.localStorage?(e=function(e,t){n.localStorage.setItem(e,t)},t=function(e){return n.localStorage.getItem(e)},r=function(){n.localStorage.clear()}):(e=function(){},t=function(){},r=function(){}),n.Game=f}(window);
